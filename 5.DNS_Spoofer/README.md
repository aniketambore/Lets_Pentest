<div align="center">
    <img src="Images/header.png?raw=true" alt="DNS Spoofer Logo"/>
</div>

<h3 align="center"> DNS Spoofer - Intercepting and Modifying Packets ! </h3>

---


## Modules Used
- [scapy](https://scapy.readthedocs.io/en/latest/introduction.html)
- [netfilterqueue](https://pypi.org/project/NetfilterQueue/)
- [argparse](https://docs.python.org/3/library/argparse.html#module-argparse)
- sys
- time

## Installing **netfilterqueue**
```
apt-get install build-essential python-dev libnetfilter-queue-dev
pip install NetfilterQueue
```

OR

```
git clone https://github.com/kti/python-netfilterqueue.git
cd python-netfilterqueue
python setup.py install
```


## Before Running the Script
Redirecting Packets to the queue using iptables.
If we're the MiTM, any request that we're going to get or responses will be trapped in a queue.

### For Testing on Local Computer
- Run in terminal
   - sudo iptables -I OUTPUT -j NFQUEUE --queue-num 0
   - sudo iptables -I INPUT -j NFQUEUE --queue-num 0

### For Testing on Remote Computer on Network
- Run in terminal
   - sudo iptables -I FORWARD -j NFQUEUE --queue-num 0


## Usage
![Usage Screenshot](Images/usage_ss.png "DNS Spoofer Usage")

```shell script
python dns_spoof.py -rw [Real_Web] -fw [Fake_Web_IP] -qm [Queue_Num]
```

- **Real_Web** (eg. google.com,bing.com,go.com etc)
- **Fake_Web_IP** (eg. IP of the fake website to spoof)
- **Queue_Num** (eg. Queue Num that, you set with the help of iptables)


### Example
```shell script
python dns_spoof.py -rw go.com -fw 10.0.2.15 -qm 1
```

|          Before                           |               After                    |
|-------------------------------------------|----------------------------------------|
|   ![Before](Images/before.png "Before")   |   ![After](Images/after.png "After")   |

## Contributing:

 - Fork it !
 - Create your feature branch: `git checkout -b my-new-feature`
 - Commit your changes: `git commit -am 'Add some feature'`
 - Push to the branch: `git push origin my-new-feature`
 - Submit a pull request.
